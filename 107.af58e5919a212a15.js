"use strict";(self.webpackChunkguided_random_encounter_generator=self.webpackChunkguided_random_encounter_generator||[]).push([[107],{1107:(dt,q,d)=>{d.r(q),d.d(q,{GenerateModule:()=>ht});var m=d(6895),$=d(2342),ee=d(4466),v=d(6132),te=d(1546),c=d(4432),J=d(1135),O=d(4004),t=d(8256),T=d(2966),g=d(314),y=d(767),h=d(5042);class G{constructor(){this.d6=new h.K,this.SUPPORTED_SYSTEMS=v.B,this.PERSISTENCE_TYPES=y.$}deriveStockingList(s,e,r,i){if(this.verifyDeriveStockingList(r,i),null==i||(0,c.xb)(i)){const p=s.retrieveAll(y.$.monsterEncounterList).filter(f=>f.system==e).find(f=>f.name.includes(`Level ${r}`));null!=p?this.stockingList=p:(0,g._)(`Stocking list not found for system ${e}, level ${r}`)}else this.stockingList=s.retrieveReference(i,this.PERSISTENCE_TYPES.monsterEncounterList)}deriveUnguardedTreasureType(s,e,r){const i=r??1,a=s.retrieveAll(this.PERSISTENCE_TYPES.treasureList);for(const o of a)if("Unguarded Treasure"===o.name&&o.system==e)for(const p of o.entries)if((0,c.Kh)(i,p.chanceOf))return void(this.unguardedTreasureType=s.retrieveReference([p.reference,e],p.persistenceType,["type","system"]))}verifyDeriveStockingList(s,e){null==s&&(null==e||(0,c.xb)(e))&&(0,g._)("Either a stocking list reference or a dungeon level is required")}}class N{constructor(s){this.rooms=[],(0,c.EO)(this,s)}}class k{get hasMonster(){return!(0,c.xb)(this.monsters)}get hasTrap(){return!(0,c.xb)(this.trap)}get hasTreasure(){return!(0,c.xb)(this.treasure)}get isEmpty(){return!(this.hasMonster||this.hasTreasure||this.isSpecial||this.hasTrap)}get isSpecial(){return!(0,c.xb)(this.specialFeature)}constructor(s){this.monsters=[],this.specialFeature="",this.trap="",this.treasure=[],(0,c.EO)(this,s)}}function l(...n){let s=0;if(n[0]instanceof h.K||Array.isArray(n))n.forEach(e=>{if(Array.isArray(e))e.forEach(r=>s+=l(r));else for(let r=0;r<e.no;r++)s+=e.multiplier*(ne(e)+e.modifier)});else{const{no:e,pips:r,modifier:i,multiplier:a}=n;s+=l(new h.K({no:e,pips:r,modifier:i,multiplier:a}))}return s}function x(n,s){const r=l(void 0===s?new h.K:s);for(const i of n.keys())if(i===r)return" "+n.get(i)+" ";return(0,g._)(`Unable to find list entry for result of ${r}`),""}function ne(n){return Math.floor(Math.random()*n.pips)+1}class E{constructor(s){this.name="",this.quantity=0,(0,c.EO)(this,s)}}class C{constructor(s){this.isLair=!1,this.name="",this.quantity=0,this.treasure=[],this.treasureType="",(0,c.EO)(this,s),this.handleTreasureResults()}handleTreasureResults(){(0,c.xb)(this.treasure)||(this.treasure=this.treasure.map(s=>new E(s)))}}var ie=d(1581),u=d(443);class W{constructor(){this.d100=new h.K({pips:100}),this.PERSISTENCE_TYPES=y.$,this.result=[]}generateEncounterFromList(s,e){this.result=[];const r=l(s.diceToRoll);for(let i of s.entries)(0,c.Kh)(r,i.chanceOf)&&this.result.push(this.generateReferenceEncounter(i));return e||this.squashResult(),this.result}followingHandledAsCustom(s){this.result.push(new C({name:s.name,quantity:l(s.quantity)}))}followingHandledAsReference(s){const e=this.retrieveMonsterReference(s.name);return!!(0,c.gK)(e)&&(this.result.push(this.generateReferenceEncounter(new ie.b({chanceOf:new u.P({low:1,high:100}),persistenceType:this.PERSISTENCE_TYPES.monsterType,reference:e.name}))),!0)}followingHandledAsTable(s){const e=this.retrieveEncounterReferenceTable(s.name);if(!(0,c.gK)(e))return!1;const r=this.result;return r.push(...this.generateEncounterFromList(e,!0)),this.result=r,!0}generateReferenceEncounter(s){let e=new C;const r=this.retrieveMonsterReference(s.reference);if((0,c.gK)(r))this.populateEncounterResult(e,r),this.handleTreasure(r,e),this.handleConsorts(r,e),this.handleRetinue(r,e);else{const i=this.retrieveEncounterReferenceTable(s.reference);e=this.generateEncounterFromList(i,!0)[0]}return e}handleConsorts(s,e){if(s.consorts){let r;for(const i of s.consorts){r=0===i.every?1:Math.floor(e.quantity/i.every);for(let a=0;a<r;a++)l(this.d100)<=i.pctChance&&(this.followingHandledAsTable(i)||this.followingHandledAsReference(i)||this.followingHandledAsCustom(i))}}}handleRetinue(s,e){if(s.retinue){let r;for(const i of s.retinue)r=Math.floor(e.quantity/i.each)*i.incChance,l(this.d100)<=r&&(this.followingHandledAsTable(i)||this.followingHandledAsReference(i)||this.followingHandledAsCustom(i))}}squashResult(){const s=[];(function re(n,s){let e;for(const r of n)e=(0,c.ju)(r,s,["name"]),-1===e?s.push(new C(r)):(s[e].quantity+=r.quantity,s[e].treasure.push(...r.treasure),r.isLair&&!s[e].isLair&&(s[e].isLair=!0))})(this.result,s),function se(n){let s;for(const e of n)if(!(0,c.xb)(e.treasure)){const r=[];for(const i of e.treasure)s=(0,c.ju)(i,r,["name"]),-1===s?r.push(new E(i)):r[s].quantity+=i.quantity;e.treasure=r}}(s),s.reverse(),this.result=s}}var ae=d(7263);class D{constructor(){this.d100=new h.K({pips:100}),this.TREASURE_ARTICLE_TYPES=ae.U}generateSpecie(s){if(l(this.d100)<=s.chanceOf){const e=new E({name:s.name});return e.quantity=l(s.quantity),e}return null}generateTreasureByTreasureType(s){const e=[];for(const r of s.entries)if((0,c.xb)(r.type)){const i=this.generateMagicItem(r);(0,c.gK)(i)&&e.push(...i)}else e.push(...this.generateTreasureByArticleType(r));return e}generateTreasureByArticleType(s){const e=[];switch(this.TREASURE_ARTICLE_TYPES[s.type]){case this.TREASURE_ARTICLE_TYPES.GEMS:this.pushToResults(this.generateGems(s),e);break;case this.TREASURE_ARTICLE_TYPES.JEWELRY:this.pushToResults(this.generateJewelry(s),e);break;case this.TREASURE_ARTICLE_TYPES.MAGIC_ITEM:this.pushToResults(this.generateMagicItem(s),e);break;case this.TREASURE_ARTICLE_TYPES.SPECIE:this.pushToResults(this.generateSpecie(s),e);break;case this.TREASURE_ARTICLE_TYPES.TREASURE_MAP:this.pushToResults(this.generateTreasureMap(s),e);break;default:(0,g._)(`Unsupported type ${s.type}`)}return e}pushToResults(s,e){if(null!=s)if(Array.isArray(s))for(const r of s)this.pushToResults(r,e);else e.push(s)}}class Y extends E{constructor(s){super(s),this.results=[],this.massageResults(s)}massageResults(s){void 0!==s&&s.results&&s.results.length&&(this.results=s.results.map(e=>new E(e)))}}function I(n,s){const e=s.findIndex(r=>r.value===n.value);-1===e?s.push(n):s[e].quantity+=n.quantity}function M(n){return(0,c.gK)(n)&&(0,c.gK)(n.quantity)?(0,c.gK)(n.quantity.pips)?l(n.quantity):n.quantity:1}function U(n){const s=new m.JJ("en-US");return"".concat(`${s.transform(n.quantity,"1.0")}`," ",n.name.includes("-")?n.name.split("-")[n.name.split("-").length-1]:n.name)}var F=d(8265),L=(()=>{return(n=L||(L={})).COPPER="Copper Pieces",n.SILVER="Silver Pieces",n.ELECRTUM="Electrum Pieces",n.GOLD="Gold Pieces",n.PLATINUM="Platinum Pieces",L;var n})();class b extends E{constructor(s){super(),this.denomination=L.GOLD,this.value=0,(0,c.EO)(this,s)}}let oe=(()=>{class n{constructor(){this.d6=new h.K,this.d20=new h.K({pips:20}),this.GEM_ROLL_TABLE=[10,10,10,10,50,50,50,50,50,100,100,100,100,100,100,500,500,500,500,1e3]}generateGems(e){if(l(e.diceRolled)<=e.chanceOf){this.gemResult=[];const r=l(e.quantity);let i;for(let a=0;a<r;a++)i=this.generateGem(),I(i,this.gemResult);return this.gemResult.sort((a,o)=>a.value-o.value),this.gemResult}return null}generateGem(){const e=new b({quantity:1,value:this.generateGemValue()});return e.name=`Gem (${e.value} ${e.denomination})`,e}generateGemValue(){const e=l(this.d20);return this.GEM_ROLL_TABLE[e-1]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ce=(()=>{class n{constructor(){this.valueDice=new h.K({no:3,pips:6})}generateJewelryPieces(e){if(l(e.diceRolled)<=e.chanceOf){this.jewelryResult=[];const r=l(e.quantity);let i;for(let a=0;a<r;a++)i=this.generateJewelry(),I(i,this.jewelryResult);return this.jewelryResult.sort((a,o)=>a.value-o.value),this.jewelryResult}return null}generateJewelry(){const e=new b({quantity:1,value:this.generateJewelryValue()});return e.name=`Jewelry (${e.value} ${e.denomination})`,e}generateJewelryValue(){return 100*l(this.valueDice)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var S=(()=>{return(n=S||(S={}))[n.LAW=0]="LAW",n[n.NEUTRALITY=1]="NEUTRALITY",n[n.CHAOS=2]="CHAOS",S;var n})();let le=(()=>{class n{constructor(e){this.dataService=e,this.d12=new h.K({pips:12}),this.d20=new h.K({pips:20}),this.d100=new h.K({pips:100}),this.SWORD_INTELLIGENCE=new Map([[new u.P({low:1,high:14}),0],[new u.P({low:15,high:15}),0],[new u.P({low:16,high:16}),0],[new u.P({low:17,high:17}),9],[new u.P({low:18,high:18}),10],[new u.P({low:18,high:19}),11],[new u.P({low:20,high:20}),12]]),this.SWORD_ALIGNMENTS=new Map([[new u.P({low:1,high:13}),S.LAW],[new u.P({low:14,high:18}),S.NEUTRALITY],[new u.P({low:19,high:20}),S.CHAOS]]),this.SWORD_COMMUNICATION_MODES=new Map([[new u.P({low:1,high:6}),"None"],[new u.P({low:7,high:9}),"Empathy"],[new u.P({low:10,high:12}),"Speech"]]),this.SWORD_READING=new Map([[new u.P({low:1,high:10}),"No"],[new u.P({low:11,high:12}),"Yes"]]),this.SWORD_LANGUAGES_KNOWN=new Map([[new u.P({low:0,high:0}),0],[new u.P({low:1,high:50}),1],[new u.P({low:51,high:70}),2],[new u.P({low:71,high:85}),3],[new u.P({low:86,high:95}),4],[new u.P({low:96,high:99}),5]]),this.SWORD_SPECIAL_PURPOSES=["Slay magic-users (includes elves)","Slay clerics","Slay Fighters","Slay A specific monster","Defeat Law (if sword is Lawful, defeat Chaos)","Defeat Chaos(if sword is Chaotic, defeat Law)"],this.PERSISTENCE_TYPES=y.$}appendSwordCharacteristics(e){let r=e;return r.includes("Sword")&&!r.includes("Map to")&&(this.isSpecialPurpose=20==l(this.d20),this.swordIntelligence=this.isSpecialPurpose?12:this.determineIntelligence(),r+="".concat(this.appendAlignment(),this.appendSpecialPurpose(),this.appendIntelligence(),this.appendEgoism(),this.appendCommunicationMode(),this.appendLanguages(),this.appendPowers(),")")),r}determineIntelligence(){let e=l(this.d20),r=0;for(const i of this.SWORD_INTELLIGENCE.keys())(0,c.Kh)(e,i)&&(r=this.SWORD_INTELLIGENCE.get(i));return r}appendAlignment(){let e="";const r=l(this.d20);for(const i of this.SWORD_ALIGNMENTS.keys())if((0,c.Kh)(r,i)){switch(this.swordAlignment=this.SWORD_ALIGNMENTS.get(i),this.SWORD_ALIGNMENTS.get(i)){case S.LAW:e="Lawful";break;case S.NEUTRALITY:e="Neutral";break;case S.CHAOS:e="Chaotic";break;default:(0,g._)(`Unsupported alignment ${this.SWORD_ALIGNMENTS.get(i)?.toString()} encountered`)}break}return(0,c.xb)(e)?"":` (Alignment: ${e}`}appendCommunicationMode(){let e="";if(this.swordIntelligence>6)for(const r of this.SWORD_COMMUNICATION_MODES.keys())if((0,c.Kh)(this.swordIntelligence,r)){e=this.SWORD_COMMUNICATION_MODES.get(r);break}return(0,c.xb)(e)?"":`; Communication Mode: ${e}`}appendEgoism(){let e="";return this.isSpecialPurpose?e="12":this.swordIntelligence>6&&(e=l(this.d12).toString()),(0,c.xb)(e)?"":`; Egoism: ${e}`}appendIntelligence(){return this.swordIntelligence>6?`; Intelligence: ${this.swordIntelligence}`:""}appendLanguages(){if(this.swordIntelligence<10)return"";let e=this.determineSwordLanguages();if(-1===e){e++;for(let r=0;r<2;r++)e+=this.determineSwordLanguages(new h.K({pips:100,modifier:-1}))}return`; Languages Spoken: ${e}`}appendPowers(){const e=[],r=this.dataService.retrieveReference("Primary Powers",this.PERSISTENCE_TYPES.magicWeaponPowerTable),i=this.dataService.retrieveReference("Extraordinary Powers",this.PERSISTENCE_TYPES.magicWeaponPowerTable);let a=0;switch(this.swordIntelligence){case 12:a=3,e.push(...this.rollOnWeaponPowerTable(i)),e.push("Read Magic");break;case 11:a=3,e.push("Read Magic");break;case 10:case 9:a=3;break;case 8:a=2;break;case 7:a=1}return e.push(...this.rollOnWeaponPowerTable(r,a)),e.length?`; Special Powers: ${e.join(", ")}`:""}appendSpecialPurpose(){if(this.isSpecialPurpose){const e=this.SWORD_SPECIAL_PURPOSES[l(new h.K({pips:this.SWORD_SPECIAL_PURPOSES.length,modifier:-1}))];let r="";switch(this.swordAlignment){case S.LAW:r="Paralyze Chaotic Opponents";break;case S.NEUTRALITY:r="+1 to All Saving Throws";break;case S.CHAOS:r="Disintegrate Lawful Opponents";break;default:(0,g._)(`Unsupported alignment ${this.swordAlignment} encountered`)}return`; Special Purpose: ${e} (${r})`}return""}determineSwordLanguages(e){const r=l(e||this.d100);let i=-1;for(const a of this.SWORD_LANGUAGES_KNOWN.keys())if((0,c.Kh)(r,a)){i=this.SWORD_LANGUAGES_KNOWN.get(a);break}return i}rollOnWeaponPowerTable(e,r){r=(0,c.gK)(r)?r:1;const i=[];let a;for(let o=0;o<r;o++){a=l(e.diceToRoll);for(const p of e.entries)if((0,c.Kh)(a,p.chanceOf))switch(p.persistenceType){case this.PERSISTENCE_TYPES.magicWeaponPower:i.push(p.reference);break;case this.PERSISTENCE_TYPES.magicWeaponPowerTable:i.push(...this.rollOnWeaponPowerTable(this.dataService.retrieveReference(p.reference,p.persistenceType)));break;default:(0,g._)(`Unsupported persistence type ${p.persistenceType} encountered`)}}return i}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.L))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),B=(()=>{class n extends D{constructor(e,r,i,a){super(),this.gemService=e,this.jewelryService=r,this.swordService=i,this.dataService=a,this.PERSISTENCE_TYPES=y.$}generateGems(e){return this.gemService.generateGems(e)}generateJewelry(e){return this.jewelryService.generateJewelryPieces(e)}generateMagicItem(e){let r;const i=[],a=M(e);for(let o=0;o<a;o++)r=this.dataService.retrieveReference(e.name,this.PERSISTENCE_TYPES.magicItemTable),(0,c.gK)(r)||(r=this.dataService.retrieveReference(e.name,this.PERSISTENCE_TYPES.magicItem)),(0,c.gK)(r.entries)?i.push(...this.generateMagicItemFromTable(r).map(p=>this.convertNamedItemToTreasureResult(p))):i.push(this.convertNamedItemToTreasureResult(r));return(0,c.xb)(i)?null:i}convertNamedItemToTreasureResult(e){const r=new E({name:this.swordService.appendSwordCharacteristics(e.name)});return(0,c.gK)(e.quantity)&&(r.quantity=e.quantity.pips?l(e.quantity):e.quantity),r}generateMagicItemFromTable(e){const r=l(e.diceToRoll);let a,i=[];for(const o of e.entries)if((0,c.Kh)(r,o.chanceOf)&&(a=this.dataService.retrieveReference(o.reference,o.persistenceType),!(0,c.gK)(a)&&o.persistenceType===this.PERSISTENCE_TYPES.magicItemTable&&(a=this.dataService.retrieveReference(o.reference,this.PERSISTENCE_TYPES.treasureMap)),(0,c.gK)(a)||(0,g._)(`Unable to find reference for ${o.reference}, type ${o.persistenceType}`),o.persistenceType))switch(o.persistenceType){case this.PERSISTENCE_TYPES.magicItemTable:i.push(...this.generateMagicItemFromTable(a));break;case this.PERSISTENCE_TYPES.magicItem:i.push(a);break;case this.PERSISTENCE_TYPES.treasureMap:const p=this.generateTreasureMap(a);p&&i.push(...p.map(X=>new F.Z({name:X.name,quantity:X.quantity})));break;case this.PERSISTENCE_TYPES.treasureMapRef:const f=this.dataService.retrieveReference(o.reference,this.PERSISTENCE_TYPES.treasureMapRef);i.push(new F.Z({name:`Map to ${U(new E({name:f.name,quantity:l(f.quantity)}))}`,quantity:1}));break;default:(0,g._)(`Unsupported item type ${o.persistenceType} encountered.`)}return i}generateTreasureMap(e){let r,i;const a=[],o=M(e);for(let p=0;p<o;p++)r=this.dataService.retrieveReference(e.name,this.PERSISTENCE_TYPES.treasureMap),i=this.generateTreasureMapResult(r),(0,c.gK)(i)&&i?.results&&a.push(new E({name:`Map to ${i.results.map(f=>U(f)).join(", ")}`,quantity:1}));return(0,c.xb)(a)?null:a}generateTreasureMapResult(e){const r=new Y({name:e.name}),i=l(e.diceToRoll);let a;for(const o of e.entries)if((0,c.Kh)(i,o.chanceOf))switch(a=this.dataService.retrieveReference(o.reference,o.persistenceType),o.persistenceType){case this.PERSISTENCE_TYPES.magicItemTable:r.results.push(...this.generateMagicItemFromTable(a).map(f=>this.convertNamedItemToTreasureResult(f)));break;case this.PERSISTENCE_TYPES.treasureArticle:console.warn(`${o.persistenceType} Encountered`);break;case this.PERSISTENCE_TYPES.treasureMap:const p=this.generateTreasureMapResult(a);(0,c.gK)(p)&&p?.results&&r.results.push(...p.results);break;case this.PERSISTENCE_TYPES.treasureMapRef:r.results.push(...this.generateTreasureByArticleType(a));break;default:(0,g._)(`Unsupported type ${o.persistenceType} encountered.`)}return r}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(oe),t.LFG(ce),t.LFG(le),t.LFG(T.L))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ue=(()=>{class n extends W{constructor(e,r){super(),this.dataService=e,this.treasureService=r}handleTreasure(e,r){if(r.treasureType=e.treasureType,r.isLair&&!(0,c.xb)(e.treasureType)){const i=this.dataService.retrieveReference(e.treasureType,this.PERSISTENCE_TYPES.treasureType,"type");r.treasure.push(...this.treasureService.generateTreasureByTreasureType(i))}else if(r.isLair&&!(0,c.xb)(e.treasurePerCap))for(let i=0;i<r.quantity;i++)for(const a of e.treasurePerCap)if((0,c.gK)(a.type)){const o=this.dataService.retrieveReference(e.treasureType,this.PERSISTENCE_TYPES.treasureType,"type");r.treasure.push(...this.treasureService.generateTreasureByTreasureType(o))}else l(a.diceRolled)<=a.chanceOf&&r.treasure.push(...this.treasureService.generateTreasureByArticleType(a))}populateEncounterResult(e,r){e.name=r.name,e.quantity=l(r.quantity)}retrieveEncounterReferenceTable(e){return this.dataService.retrieveReference(e,this.PERSISTENCE_TYPES.monsterEncounterList)}retrieveMonsterReference(e){return this.dataService.retrieveReference(e,this.PERSISTENCE_TYPES.monsterType)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.L),t.LFG(B))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),pe=(()=>{class n{constructor(){this.d6=new h.K,this.d100=new h.K({pips:100}),this.GEM_SEQUENTIAL_VALUE=[10,50,100,500,1e3,5e3,1e4,25e3,5e4,1e5,5e5],this.GEM_VALUE_THRESHOLDS=new Map([[10,10],[25,50],[75,100],[90,500],[100,1e3]])}generateGems(e){if(l(e.diceRolled)<=e.chanceOf){this.gemResult=[];const r=l(e.quantity);let i;this.deriveBumpEvery(r);for(let a=0;a<r;a++)this.nthGem=a+1,i=this.generateGem(),I(i,this.gemResult);return this.gemResult.sort((a,o)=>a.value-o.value),this.gemResult}return null}bumpGemValue(e){let r=e;if(r!==this.GEM_SEQUENTIAL_VALUE[this.GEM_SEQUENTIAL_VALUE.length-1]&&1===l(this.d6)){const i=this.GEM_SEQUENTIAL_VALUE.findIndex(a=>a===r)+1;0!=i&&(r=this.GEM_SEQUENTIAL_VALUE[i],r=this.bumpGemValue(r))}return r}checkForBump(e){let r=e;return this.nthGem%this.bumpEvery==0&&(r=this.bumpGemValue(r)),r}deriveBumpEvery(e){this.bumpEvery=e>=50?10:e>=10?5:1}generateGem(){const e=new b({quantity:1,value:this.generateGemValue()});return e.name=`Gem (${e.value} ${e.denomination})`,e}generateGemValue(){const e=l(this.d100);let r=-1;for(const i of this.GEM_VALUE_THRESHOLDS.keys())if(e<=i){r=this.GEM_VALUE_THRESHOLDS.get(i);break}return r=this.checkForBump(r),-1===r&&(0,g._)(`No gem value threshold found for roll ${e}`),r}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ge=(()=>{class n{constructor(){this.d100=new h.K({pips:100}),this.JEWELRY_VALUE_THRESHOLDS=new Map([[20,new h.K({multiplier:100,no:3})],[80,new h.K({multiplier:1e3})],[100,new h.K({multiplier:1e3,pips:10})]])}generateJewelry(e){if(l(e.diceRolled)<=e.chanceOf){this.jewelResult=[];const r=l(e.quantity);let i;for(let a=0;a<r;a++)i=this.generateJewel(),I(i,this.jewelResult);return this.jewelResult.sort((a,o)=>a.value-o.value),this.jewelResult}return null}generateJewel(){const e=new b({value:this.generateJewelryValue(),quantity:1});return e.name=`Jewelry (${e.value} ${e.denomination})`,e}generateJewelryValue(){const e=l(this.d100);let r=-1;for(const i of this.JEWELRY_VALUE_THRESHOLDS.keys())if(e<=i){r=l(this.JEWELRY_VALUE_THRESHOLDS.get(i));break}return-1===r&&(0,g._)(`No jewelry value threshold found for roll ${e}`),r}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var _=(()=>{return(n=_||(_={}))[n.LAW=0]="LAW",n[n.NEUTRALITY=1]="NEUTRALITY",n[n.CHAOS=2]="CHAOS",_;var n})();let he=(()=>{class n{constructor(e){this.dataService=e,this.d12=new h.K({pips:12}),this.d100=new h.K({pips:100}),this.SWORD_ALIGNMENTS=new Map([[new u.P({low:1,high:65}),_.LAW],[new u.P({low:66,high:90}),_.NEUTRALITY],[new u.P({low:91,high:100}),_.CHAOS]]),this.SWORD_COMMUNICATION_MODES=new Map([[new u.P({low:1,high:6}),"None"],[new u.P({low:7,high:9}),"Empathy"],[new u.P({low:10,high:11}),"Speech"],[new u.P({low:12,high:12}),"Telepathy"]]),this.SWORD_LANGUAGES_KNOWN=new Map([[new u.P({low:0,high:0}),0],[new u.P({low:1,high:50}),1],[new u.P({low:51,high:70}),2],[new u.P({low:71,high:85}),3],[new u.P({low:86,high:95}),4],[new u.P({low:96,high:99}),5]]),this.SWORD_SPECIAL_PURPOSES=["Slay Magic-Users","Slay Fighting-Men","Defeat Law","Slay Clerics","Slay Monsters","Defeat Chaos"],this.PERSISTENCE_TYPES=y.$}appendSwordCharacteristics(e){let r=e;return r.includes("Sword")&&!r.includes("Map to")&&(this.isSpecialPurpose=l(this.d100)>90,this.swordIntelligence=this.isSpecialPurpose?12:l(this.d12),r+="".concat(this.appendAlignment(),this.appendSpecialPurpose(),this.appendIntelligence(),this.appendEgoism(),this.appendCommunicationMode(),this.appendLanguages(),this.appendPowers(),")")),r}appendAlignment(){let e="";const r=l(this.d100);for(const i of this.SWORD_ALIGNMENTS.keys())if((0,c.Kh)(r,i)){switch(this.swordAlignment=this.SWORD_ALIGNMENTS.get(i),this.SWORD_ALIGNMENTS.get(i)){case _.LAW:e="Lawful";break;case _.NEUTRALITY:e="Neutral";break;case _.CHAOS:e="Chaotic";break;default:(0,g._)(`Unsupported alignment ${this.SWORD_ALIGNMENTS.get(i)?.toString()} encountered`)}break}return(0,c.xb)(e)?"":` (Alignment: ${e}`}appendCommunicationMode(){let e="";if(this.swordIntelligence>6)for(const r of this.SWORD_COMMUNICATION_MODES.keys())if((0,c.Kh)(this.swordIntelligence,r)){e=this.SWORD_COMMUNICATION_MODES.get(r);break}return(0,c.xb)(e)?"":`; Communication Mode: ${e}`}appendEgoism(){let e="";return this.isSpecialPurpose?e="12":this.swordIntelligence>6&&(e=l(this.d12).toString()),(0,c.xb)(e)?"":`; Egoism: ${e}`}appendIntelligence(){return this.swordIntelligence>6?`; Intelligence: ${this.swordIntelligence}`:""}appendLanguages(){if(this.swordIntelligence<10)return"";let e=this.determineSwordLanguages();if(-1===e){e++;for(let r=0;r<2;r++)e+=this.determineSwordLanguages(new h.K({pips:100,modifier:-1}))}return`; Languages Spoken: ${e}`}appendPowers(){const e=[],r=this.dataService.retrieveReference("Primary Powers",this.PERSISTENCE_TYPES.magicWeaponPowerTable),i=this.dataService.retrieveReference("Extraordinary Ability Table",this.PERSISTENCE_TYPES.magicWeaponPowerTable);let a=0;switch(this.swordIntelligence){case 12:a=3,e.push(...this.rollOnWeaponPowerTable(i));break;case 11:a=3,e.push("Read Magic");break;case 10:case 9:a=3;break;case 8:a=2;break;case 7:a=1}return e.push(...this.rollOnWeaponPowerTable(r,a)),e.length?`; Special Powers: ${e.join(", ")}`:""}appendSpecialPurpose(){if(this.isSpecialPurpose){const e=this.SWORD_SPECIAL_PURPOSES[l(new h.K({pips:this.SWORD_SPECIAL_PURPOSES.length,modifier:-1}))];let r="";switch(this.swordAlignment){case _.LAW:r="Paralyze Chaotic Opponents";break;case _.NEUTRALITY:r="+1 to All Saving Throws";break;case _.CHAOS:r="Disintegrate Lawful Opponents";break;default:(0,g._)(`Unsupported alignment ${this.swordAlignment} encountered`)}return`; Special Purpose: ${e} (${r})`}return""}determineSwordLanguages(e){const r=l(e||this.d100);let i=-1;for(const a of this.SWORD_LANGUAGES_KNOWN.keys())if((0,c.Kh)(r,a)){i=this.SWORD_LANGUAGES_KNOWN.get(a);break}return i}rollOnWeaponPowerTable(e,r){r=(0,c.gK)(r)?r:1;const i=[];let a;for(let o=0;o<r;o++){a=l(e.diceToRoll);for(const p of e.entries)if((0,c.Kh)(a,p.chanceOf))switch(p.persistenceType){case this.PERSISTENCE_TYPES.magicWeaponPower:i.push(p.reference);break;case this.PERSISTENCE_TYPES.magicWeaponPowerTable:i.push(...this.rollOnWeaponPowerTable(this.dataService.retrieveReference(p.reference,p.persistenceType)));break;default:(0,g._)(`Unsupported persistence type ${p.persistenceType} encountered`)}}return i}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.L))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),K=(()=>{class n extends D{constructor(e,r,i,a){super(),this.dataService=e,this.gemsService=r,this.jewelsService=i,this.swordService=a,this.PERSISTENCE_TYPES=y.$,this.decimalPipe=new m.JJ("en-US")}generateGems(e){return this.gemsService.generateGems(e)}generateJewelry(e){return this.jewelsService.generateJewelry(e)}generateMagicItem(e){let r;const i=[],a=M(e);for(let o=0;o<a;o++)r=this.dataService.retrieveReference(e.name,this.PERSISTENCE_TYPES.magicItemTable),(0,c.gK)(r)||(r=this.dataService.retrieveReference(e.name,this.PERSISTENCE_TYPES.magicItem)),(0,c.gK)(r.entries)?i.push(...this.generateMagicItemFromTable(r).map(p=>this.convertNamedItemToTreasureResult(p))):i.push(this.convertNamedItemToTreasureResult(r));return(0,c.xb)(i)?null:i}generateTreasureMap(e){let r,i;const a=[],o=M(e);for(let p=0;p<o;p++)r=this.dataService.retrieveReference(e.name,this.PERSISTENCE_TYPES.treasureMap),i=this.generateTreasureMapResult(r),(0,c.gK)(i)&&i?.results&&a.push(new E({name:`Map to ${i.results.map(f=>U(f)).join(", ")}`,quantity:1}));return(0,c.xb)(a)?null:a}generateTreasureMapResult(e){const r=new Y({name:e.name}),i=l(e.diceToRoll);let a;for(const o of e.entries)if((0,c.Kh)(i,o.chanceOf))switch(a=this.dataService.retrieveReference(o.reference,o.persistenceType),o.persistenceType){case this.PERSISTENCE_TYPES.magicItemTable:r.results.push(...this.generateMagicItemFromTable(a).map(f=>this.convertNamedItemToTreasureResult(f)));break;case this.PERSISTENCE_TYPES.treasureArticle:console.warn(`${o.persistenceType} Encountered`);break;case this.PERSISTENCE_TYPES.treasureMap:const p=this.generateTreasureMapResult(a);(0,c.gK)(p)&&p?.results&&r.results.push(...p.results);break;case this.PERSISTENCE_TYPES.treasureMapRef:r.results.push(...this.generateTreasureByArticleType(a));break;default:(0,g._)(`Unsupported type ${o.persistenceType} encountered.`)}return r}convertNamedItemToTreasureResult(e){const r=new E({name:this.swordService.appendSwordCharacteristics(e.name)});return(0,c.gK)(e.quantity)&&(r.quantity=e.quantity.pips?l(e.quantity):e.quantity),r}generateMagicItemFromTable(e){const r=l(e.diceToRoll);let a,i=[];for(const o of e.entries)if((0,c.Kh)(r,o.chanceOf))switch(a=this.dataService.retrieveReference(o.reference,o.persistenceType),!(0,c.gK)(a)&&o.persistenceType===this.PERSISTENCE_TYPES.magicItemTable&&(a=this.dataService.retrieveReference(o.reference,this.PERSISTENCE_TYPES.treasureMap)),(0,c.gK)(a)||(0,g._)(`Unable to find reference for ${o.reference}, type ${o.persistenceType}`),o.persistenceType){case this.PERSISTENCE_TYPES.magicItemTable:i.push(...this.generateMagicItemFromTable(a));break;case this.PERSISTENCE_TYPES.magicItem:i.push(a);break;case this.PERSISTENCE_TYPES.treasureMap:const p=this.generateTreasureMap(a);p&&i.push(...p.map(f=>new F.Z({name:f.name,quantity:f.quantity})));break;default:(0,g._)(`Unsupported item type ${o.persistenceType} encountered.`)}return i}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.L),t.LFG(pe),t.LFG(ge),t.LFG(he))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),de=(()=>{class n extends W{constructor(e,r){super(),this.dataService=e,this.treasureService=r}handleTreasure(e,r){if(r.treasureType=e.treasureType,r.isLair&&!(0,c.xb)(e.treasureType)){const i=this.dataService.retrieveReference(e.treasureType,this.PERSISTENCE_TYPES.treasureType,"type");r.treasure.push(...this.treasureService.generateTreasureByTreasureType(i))}else if(e.treasurePerCap)for(let i=0;i<r.quantity;i++)for(const a of e.treasurePerCap)l(a.diceRolled)<=a.chanceOf&&r.treasure.push(...this.treasureService.generateTreasureByArticleType(a))}populateEncounterResult(e,r){e.name=r.name,e.quantity=l(r.quantity),e.isLair=l(this.d100)<=r.pctInLair}retrieveEncounterReferenceTable(e){return this.dataService.retrieveReference(e,this.PERSISTENCE_TYPES.monsterEncounterList)}retrieveMonsterReference(e){return this.dataService.retrieveReference(e,this.PERSISTENCE_TYPES.monsterType)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.L),t.LFG(K))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),A=(()=>{class n{constructor(e,r){this.bxService=e,this.lbbService=r,this.SUPPORTED_SYSTEMS=v.B}generateEncounterFromList(e){return this.checkAndSetGeneratorService(e.system),this.generatorService.generateEncounterFromList(e)}checkAndSetGeneratorService(e){switch(this.SUPPORTED_SYSTEMS[e]){case this.SUPPORTED_SYSTEMS.BX:this.generatorService=this.bxService;break;case this.SUPPORTED_SYSTEMS.LBB:this.generatorService=this.lbbService;break;default:(0,g._)(`Unsupported system ${e} specified.`)}}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(ue),t.LFG(de))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),me=(()=>{class n extends D{generateGems(e){return(0,g._)("Method not implemented."),[]}generateJewelry(e){return(0,g._)("Method not implemented."),[]}generateMagicItem(e){return(0,g._)("Method not implemented."),[]}generateTreasureMap(e){return(0,g._)("Method not implemented."),[]}generateTreasureMapResult(e){return(0,g._)("Method not implemented."),null}constructor(){super()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),R=(()=>{class n{constructor(e,r,i){this.bxService=e,this.lbbService=r,this.wwwService=i,this.SUPPORTED_SYSTEMS=v.B}generateTreasure(e){return this.checkAndSetGeneratorService(e.system),this.generatorService.generateTreasureByTreasureType(e)}generateTreasureFromTreasureMap(e){this.checkAndSetGeneratorService(e.system);const r=this.generatorService.generateTreasureMapResult(e);return(0,c.gK)(r)?r:new Y}checkAndSetGeneratorService(e){switch(this.SUPPORTED_SYSTEMS[e]){case this.SUPPORTED_SYSTEMS.BX:this.generatorService=this.bxService;break;case this.SUPPORTED_SYSTEMS.LBB:this.generatorService=this.lbbService;break;case this.SUPPORTED_SYSTEMS.WWW:this.generatorService=this.wwwService;break;default:(0,g._)(`Unsupported system ${e} specified.`)}}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(B),t.LFG(K),t.LFG(me))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),fe=(()=>{class n extends G{constructor(e,r,i){super(),this.dataService=e,this.encounterService=r,this.treasureService=i,this.TARGET_SYSTEM="BX",this.d10=new h.K({pips:10}),this.SAMPLE_ROOM_TRAPS=new Map([[1,"Poison gas: Save vs. Poison or die"],[2,"Fog: Looks like Poison gas, but harmless"],[3,"Pit: Id6 points of damage per 10' fallen"],[4,"Ceiling Block falls: Save vs. Turn to Stone or take Id 10 points of damage"],[5,"Pendulum blade from ceiling: Id8 points of damage"],[6,"Chute: No damage, but slide to the next level down"]]),this.SAMPLE_TREASURE_TRAPS=new Map([[1,"Poison needle: Save vs. Poison or die"],[2,"Spring-fired darts: 1-6 darts hit for 1-4 points of damage each"],[3,"Flash of light: Save vs. Spells or be blinded for Id8 turns"],[4,"Poison snake"],[5,"Spray: Be sprayed with an unknown liquid that attracts Wandering Monsters; double chances for Id6 hours"],[6,"Illusion: Anything; often a monster"]]),this.SAMPLE_SPECIAL_ROOMS=new Map([[1,"Moaning room or corridor"],[2,"Room turns or sinks while the door locks"],[3,"Illusionary stairs or corridor"],[4,"Shifting block to close off corridor"],[5,"Trap door to tunnels"],[6,"Alarm that summons special monster"],[7,"Talking statue"],[8,"Magic pool whose waters have a strange effect"],[9,"Magic gate to another part of the dungeon"],[10,"Flying weapons which attack only if disturbed"]])}generateDungeon(e,r,i){this.deriveStockingList(this.dataService,this.TARGET_SYSTEM,r,i),this.deriveUnguardedTreasureType(this.dataService,this.TARGET_SYSTEM,r);const a=new N;for(let o=0;o<e;o++)a.rooms.push(this.generateRoom());return a}addMonster(e){e.monsters.push(...this.encounterService.generateEncounterFromList(this.stockingList))}addSpecial(e){e.specialFeature=`( Suggestion:${x(this.SAMPLE_SPECIAL_ROOMS,this.d10)})`}addTrap(e){e.trap=`( Suggestion:${x(this.SAMPLE_ROOM_TRAPS)})`}addTreasure(e){e.hasMonster&&this.handleTreasureFromMonster(e),e.treasure.push(...this.treasureService.generateTreasure({...this.unguardedTreasureType,system:"LBB"}))}generateRoom(){const e=new k;switch(l(this.d6)){case 1:case 2:this.addMonster(e);break;case 3:this.addTrap(e);break;case 4:this.addSpecial(e)}return this.handleTreasure(e),e}handleTreasure(e){const r=l(this.d6);e.hasMonster?r<4?this.addTreasure(e):e.monsters.forEach(i=>i.treasure=[]):e.hasMonster&&r<4||(e.hasTrap&&r<3||1===r)&&this.addTreasure(e)}handleTreasureFromMonster(e){if(!e.monsters.some(r=>!(0,c.xb)(r.treasure))){let r;for(const i of e.monsters.filter(a=>!(0,c.xb)(a.treasureType)))if(r=this.dataService.retrieveReference(this.PERSISTENCE_TYPES.treasureType,i.treasureType,"type"),(0,c.gK)(r)?e.treasure.push(...this.treasureService.generateTreasure(r)):console.warn(`Error determining treasure for ${i.name}`),!(0,c.xb)(e.treasure))return}}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.L),t.LFG(A),t.LFG(R))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Te=(()=>{class n extends G{constructor(e,r,i){super(),this.dataService=e,this.encounterService=r,this.treasureService=i,this.TARGET_SYSTEM="LBB"}generateDungeon(e,r,i){this.deriveStockingList(this.dataService,this.TARGET_SYSTEM,r,i),this.deriveUnguardedTreasureType(this.dataService,this.TARGET_SYSTEM,r);const a=new N;for(let o=0;o<e;o++)a.rooms.push(this.generateRoom());return a}generateRoom(){const e=new k;return this.handleMonsters(e),this.handleTreasure(e),e}handleMonsters(e){l(this.d6)<3&&e.monsters.push(...this.encounterService.generateEncounterFromList(this.stockingList).map(r=>new C({...r,treasure:[]})))}handleTreasure(e){(e.hasMonster?l(this.d6)<4:l(this.d6)<2)&&e.treasure.push(...this.treasureService.generateTreasure(this.unguardedTreasureType))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.L),t.LFG(A),t.LFG(R))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Q{constructor(){this.d6=new h.K}rollOnList(s){return x(s)}rollOnRange(s,e){const r=void 0===e?l(this.d6):e;for(const i of s.keys())if((0,c.Kh)(r,i))return" "+s.get(i)+" ";return(0,g._)(`Unable to find range entry for result of ${r}`),""}}let H=(()=>{class n extends Q{constructor(){super(...arguments),this.DISPOSITION=new Map([[new u.P({low:1,high:1}),"very bad for"],[new u.P({low:2,high:2}),"bad for"],[new u.P({low:3,high:4}),"indifferent to"],[new u.P({low:5,high:5}),"good for"],[new u.P({low:6,high:6}),"very good for"]]),this.TARGET=new Map([[new u.P({low:1,high:2}),"the character or characters"],[new u.P({low:3,high:4}),"the player or players"],[new u.P({low:5,high:6}),"the environment"]]),this.CHARACTER_EFFECTS=new Map([[1,"a power or feature of race or class"],[2,"the character abilities"],[3,"an intangible: time, a biological function, navigation, et al"],[4,"a consumable: rations, torches, ammunition, et al"],[5,"a non-consumable: armor, equipment, et al"],[6,"meta-elements of the character sheet: saving throws, XP, alignment, et al"]]),this.PLAYER_EFFECTS=new Map([[1,"map or directional hints"],[2,"monster or inhabitant hints"],[3,"treasure (or dearth thereof) hints"],[4,"hazard hints: other special rooms, traps, et al"],[5,"non-player character: prisoners, curious ghosts, talking statues, et al"],[6,"an immersion element: a smell, a taste, et al - in homage to the tone"]]),this.ENVIRONMENT_EFFECTS=new Map([[1,"changes to the layout or floor plan"],[2,"changes to the inhabitants, encounters, or frequency or number of either"],[3,"changes to the doors, entries, or exits - locking, unlocking, hiding, showing, et al"],[4,"translocation: one way teleporters, chutes, ladders, et al"],[5,"changes to dungeon hazards: disarming (or arming) traps, slowly flooding the level, et al"],[6,"changes to secret features: revealing or concealing, exposing or sealing, et al"]]),this.DURATION=new Map([[new u.P({low:1,high:2}),"only the immediate"],[new u.P({low:3,high:5}),"the short term"],[new u.P({low:6,high:6}),"the long term"]])}generateSpecialEffect(){const e=l(this.d6);return"Special:".concat(this.rollOnRange(this.DISPOSITION),"the party, targeting",this.rollOnRange(this.TARGET,e),", specifically",this.deriveTargetEffect(e),": the ramifications for which persist for",this.rollOnRange(this.DURATION))}deriveTargetEffect(e){return this.rollOnList(e<3?this.CHARACTER_EFFECTS:e<5?this.PLAYER_EFFECTS:this.ENVIRONMENT_EFFECTS)}}return n.\u0275fac=function(){let s;return function(r){return(s||(s=t.n5z(n)))(r||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),V=(()=>{class n extends Q{constructor(){super(...arguments),this.TYPE=new Map([[new u.P({low:1,high:1}),"whole room trap (poison gas, closing walls, etc) affecting the whole party"],[new u.P({low:2,high:3}),"small area trap (spike pit, quicksand, etc) affecting a few members of the party"],[new u.P({low:4,high:5}),"single target trap (poison needle, bladed pendulum, most treasure traps)"],[new u.P({low:6,high:6}),"trick"]]),this.SEVERITY=new Map([[new u.P({low:1,high:2}),"annoyance (time tax, translocation, resource loss, et al"],[new u.P({low:3,high:4}),"drain (physical damage, temporary blindness, monster encounter or increased encounter rate, et al)"],[new u.P({low:5,high:6}),"loss (death, permanent ability loss, one-way teleporters, or other game-enders)"]]),this.DEFENSE=new Map([[1,"Death or Poison Save"],[2,"Wand Save"],[3,"Paralysis or Petrification Save"],[4,"Breath Save"],[5,"Magic Save"],[6,"Armor Class"]])}generateTrickOrTrap(){return"A".concat(this.rollOnRange(this.TYPE),"resulting in",this.rollOnRange(this.SEVERITY),"rolled against",this.rollOnList(this.DEFENSE))}}return n.\u0275fac=function(){let s;return function(r){return(s||(s=t.n5z(n)))(r||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Se=(()=>{class n extends G{constructor(e,r,i,a,o){super(),this.dataService=e,this.encounterService=r,this.inspireSpecialService=i,this.inspireTrickOrTrapService=a,this.treasureService=o,this.TARGET_SYSTEM="LBB",this.d8=new h.K({pips:8})}generateDungeon(e,r,i){this.deriveStockingList(this.dataService,this.TARGET_SYSTEM,r,i),this.deriveUnguardedTreasureType(this.dataService,this.TARGET_SYSTEM,r);const a=new N;for(let o=0;o<e;o++)a.rooms.push(this.generateRoom());return a}addMonsters(e){e.monsters.push(...this.encounterService.generateEncounterFromList(this.stockingList))}addSpecial(e){e.specialFeature=this.inspireSpecialService.generateSpecialEffect()}addTrap(e){e.trap=this.inspireTrickOrTrapService.generateTrickOrTrap()}addTreasure(e){e.treasure.push(...this.treasureService.generateTreasure(this.unguardedTreasureType))}generateRoom(){const e=new k;switch(l(this.d8)){case 1:case 2:this.addMonsters(e);break;case 3:this.addTrap(e);break;case 4:this.addSpecial(e)}return this.handleTreasure(e),e}handleTreasure(e){const r=l(this.d8);(e.hasMonster&&r<5||e.hasTrap&&r<4||e.isSpecial&&r<3||1===r)&&this.addTreasure(e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.L),t.LFG(A),t.LFG(H),t.LFG(V),t.LFG(R))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),_e=(()=>{class n{constructor(e,r,i){this.bxService=e,this.lbbService=r,this.wwwService=i}generateDungeon(e,r,i){return this.verifySystemSet(),this.generatorService.generateDungeon(e,r,i)}setSystemSelection(e){const r=v.B[e];switch(r){case v.B.BX:this.generatorService=this.bxService;break;case v.B.LBB:this.generatorService=this.lbbService;break;case v.B.WWW:this.generatorService=this.wwwService;break;default:(0,g._)(`Unsupported system ${r} detected`)}}verifySystemSet(){(0,c.gK)(this.generatorService)||(0,g._)("System has not been selected: please select a system in order to continue")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(fe),t.LFG(Te),t.LFG(Se))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var P=d(4229),w=d(433);function Ee(n,s){if(1&n&&(t.TgZ(0,"div")(1,"span"),t._uU(2,"\u2022"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&n){const e=s.$implicit;t.xp6(4),t.AsE("",e.quantity," ",e.name,"")}}function ye(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Ee,5,2,"div",2),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.treasureResults)}}function ve(n,s){1&n&&(t.TgZ(0,"p"),t._uU(1,"~"),t.qZA())}let Z=(()=>{class n{constructor(){this.treasureResults=[]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-display-treasure-results"]],inputs:{treasureResults:"treasureResults"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["nil",""],[4,"ngFor","ngForOf"]],template:function(e,r){if(1&e&&(t.YNc(0,ye,2,1,"ng-container",0),t.YNc(1,ve,2,0,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",r.treasureResults.length)("ngIfElse",i)}},dependencies:[m.sg,m.O5],styles:["div[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:1em 1fr}"]}),n})();function we(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"label"),t._uU(2,"Lair?"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.isLair?"Yes":"No")}}function Re(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"label"),t._uU(2,"Carrying:"),t.qZA(),t._UZ(3,"greg-display-treasure-results",5),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(3),t.Q6J("treasureResults",e.treasure)}}function Pe(n,s){if(1&n&&(t.TgZ(0,"div",3)(1,"label"),t._uU(2,"Encountered:"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA(),t.YNc(5,we,5,1,"ng-container",4),t.YNc(6,Re,4,1,"ng-container",4),t.qZA()),2&n){const e=s.$implicit,r=s.first,i=t.oxw(2);t.Q6J("ngClass",i.divClasses),t.xp6(4),t.AsE("",e.quantity," ",e.name,""),t.xp6(1),t.Q6J("ngIf",r&&!i.suppressLair),t.xp6(1),t.Q6J("ngIf",e.treasure&&e.treasure.length)}}function Ce(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Pe,7,5,"div",2),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.encounterResults)}}function Ie(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1,"~"),t.qZA())}let j=(()=>{class n{constructor(){this.encounterResults=[]}get divClasses(){return this.suppressBottomMargin?[]:["spaced-out"]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-display-encounter-result"]],inputs:{encounterResults:"encounterResults",suppressBottomMargin:"suppressBottomMargin",suppressLair:"suppressLair"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["nil",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[4,"ngIf"],[3,"treasureResults"]],template:function(e,r){if(1&e&&(t.YNc(0,Ce,2,1,"ng-container",0),t.YNc(1,Ie,2,0,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",r.encounterResults&&r.encounterResults.length)("ngIfElse",i)}},dependencies:[m.mk,m.sg,m.O5,Z],styles:["div[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:1fr 3fr}div.spaced-out[_ngcontent-%COMP%]{margin-bottom:1em}label[_ngcontent-%COMP%]{padding-left:2em}"]}),n})(),Me=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-display-dungeon-room-property"]],inputs:{label:"label",value:"value"},decls:5,vars:2,template:function(e,r){1&e&&(t.TgZ(0,"div")(1,"label"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&e&&(t.xp6(2),t.Oqu(r.label),t.xp6(2),t.Oqu(r.value))},styles:["div[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:1fr 3fr}label[_ngcontent-%COMP%]{padding-left:2em}"]}),n})();function Le(n,s){1&n&&(t.TgZ(0,"span",8)(1,"i"),t._uU(2,"Empty"),t.qZA()())}function be(n,s){if(1&n&&t._UZ(0,"greg-display-encounter-result",9),2&n){const e=t.oxw().$implicit;t.Q6J("encounterResults",e.monsters)("suppressBottomMargin",!0)("suppressLair",!0)}}function Ae(n,s){if(1&n&&t._UZ(0,"greg-display-dungeon-room-property",10),2&n){const e=t.oxw().$implicit;t.Q6J("value",e.specialFeature)}}function Oe(n,s){if(1&n&&t._UZ(0,"greg-display-dungeon-room-property",11),2&n){const e=t.oxw().$implicit;t.Q6J("value",e.trap)}}function Ge(n,s){if(1&n&&(t.TgZ(0,"div",12)(1,"label"),t._uU(2,"Found:"),t.qZA(),t._UZ(3,"greg-display-treasure-results",13),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(3),t.Q6J("treasureResults",e.treasure)}}function Ne(n,s){if(1&n&&(t.TgZ(0,"section")(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"div"),t.YNc(4,Le,3,0,"span",3),t.YNc(5,be,1,3,"greg-display-encounter-result",4),t.YNc(6,Ae,1,1,"greg-display-dungeon-room-property",5),t.YNc(7,Oe,1,1,"greg-display-dungeon-room-property",6),t.YNc(8,Ge,4,1,"div",7),t.qZA()()),2&n){const e=s.$implicit,r=s.index;t.xp6(2),t.hij("",r+1,"."),t.xp6(2),t.Q6J("ngIf",e.isEmpty),t.xp6(1),t.Q6J("ngIf",e.hasMonster),t.xp6(1),t.Q6J("ngIf",e.isSpecial),t.xp6(1),t.Q6J("ngIf",e.hasTrap),t.xp6(1),t.Q6J("ngIf",e.hasTreasure)}}function ke(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Ne,9,6,"section",2),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.dungeonResult.rooms)}}function xe(n,s){1&n&&(t.TgZ(0,"div",14),t._uU(1,"~"),t.qZA())}let De=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-display-dungeon-result"]],inputs:{dungeonResult:"dungeonResult"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["nil",""],[4,"ngFor","ngForOf"],["class","indented",4,"ngIf"],[3,"encounterResults","suppressBottomMargin","suppressLair",4,"ngIf"],["label","Special",3,"value",4,"ngIf"],["label","Trap",3,"value",4,"ngIf"],["class","treasure",4,"ngIf"],[1,"indented"],[3,"encounterResults","suppressBottomMargin","suppressLair"],["label","Special",3,"value"],["label","Trap",3,"value"],[1,"treasure"],[3,"treasureResults"],[1,"nil"]],template:function(e,r){if(1&e&&(t.YNc(0,ke,2,1,"ng-container",0),t.YNc(1,xe,2,0,"ng-template",null,1,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",r.dungeonResult.rooms.length)("ngIfElse",i)}},dependencies:[m.sg,m.O5,j,Z,Me],styles:["div.treasure[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:1fr 3fr}div.treasure[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-left:2em}section[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:1em 1fr;margin-bottom:.5em}.indented[_ngcontent-%COMP%]{padding-left:2em}"]}),n})();function Ye(n,s){if(1&n&&(t.TgZ(0,"section"),t._UZ(1,"greg-display-dungeon-result",12),t.qZA()),2&n){const e=s.ngIf;t.xp6(1),t.Q6J("dungeonResult",e)}}function Ue(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"option",13),t._uU(2),t.qZA(),t.BQk()),2&n){const e=s.$implicit,r=t.oxw();t.xp6(1),t.Q6J("value",e),t.xp6(1),t.Oqu(r.supportedSystem(e))}}function Fe(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"a",2),t.NdJ("click",function(){const a=t.CHM(e).$implicit,o=t.oxw(3);return t.KtG(o.useList(a))}),t._uU(2,"+Use"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&n){const e=s.$implicit;t.xp6(4),t.Oqu(e.name)}}function Ze(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Fe,5,1,"div",7),t.BQk()),2&n){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngForOf",e)}}function qe(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Ze,2,1,"ng-container",14),t.BQk()),2&n){const e=s.ngIf;t.oxw();const r=t.MAs(37);t.xp6(1),t.Q6J("ngIf",e.length)("ngIfElse",r)}}function $e(n,s){1&n&&(t.TgZ(0,"section",15),t._uU(1,"~"),t.qZA())}let Je=(()=>{class n{get supportedSystemKeys(){return Object.keys(v.B)}supportedSystem(e){return v.B[e]}constructor(e,r){this.dataService=e,this.dungeonService=r,this.dungeonLevel=1,this.noRooms=10,this.stockingListRef="",this.system="",this.dungeonResultSource=new J.X(null)}ngOnInit(){this.dungeonResult$=this.dungeonResultSource.asObservable(),this.monsterEncounterList$=this.dataService.dataState$.pipe((0,O.U)(e=>{const r=e.monsterEncounterLists.map(i=>new te.X(i));return(0,c.L1)(r),r}))}clearForm(){this.dungeonLevel=1,this.noRooms=10,this.stockingListRef="",this.dungeonResultSource.next(null)}generateDungeon(){this.dungeonResultSource.next(this.dungeonService.generateDungeon(this.noRooms,this.dungeonLevel,this.stockingListRef))}updateSystemSelection(e){this.dungeonService.setSystemSelection(e.target.value)}useList(e){this.stockingListRef=e.name,e.system&&this.setSystem(e.system)}setSystem(e){this.system=e,this.dungeonService.setSystemSelection(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(T.L),t.Y36(_e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-generate-dungeon"]],decls:38,vars:11,consts:[[4,"ngIf"],[1,"hang-right"],[3,"click"],[1,"config-form"],["type","number",3,"ngModel","ngModelChange"],[3,"value","change"],["value","","disabled",""],[4,"ngFor","ngForOf"],["type","text",3,"ngModel","ngModelChange"],[1,"encounter-lists"],[1,"controls"],["nil",""],[3,"dungeonResult"],[3,"value"],[4,"ngIf","ngIfElse"],[1,"nil"]],template:function(e,r){1&e&&(t.TgZ(0,"greg-page-template")(1,"first-content"),t.YNc(2,Ye,2,1,"section",0),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"second-content")(5,"span",1)(6,"a",2),t.NdJ("click",function(){return r.clearForm()}),t._uU(7,"Clear Form"),t.qZA()(),t.TgZ(8,"section",3)(9,"label"),t._uU(10,"No. Rooms:"),t.qZA(),t.TgZ(11,"span")(12,"input",4),t.NdJ("ngModelChange",function(a){return r.noRooms=a}),t.qZA()(),t.TgZ(13,"label"),t._uU(14,"System:"),t.qZA(),t.TgZ(15,"span")(16,"select",5),t.NdJ("change",function(a){return r.updateSystemSelection(a)}),t.TgZ(17,"option",6),t._uU(18,"-- Select --"),t.qZA(),t.YNc(19,Ue,3,2,"ng-container",7),t.qZA()(),t.TgZ(20,"label"),t._uU(21,"Dungeon Level:"),t.qZA(),t.TgZ(22,"span")(23,"input",4),t.NdJ("ngModelChange",function(a){return r.dungeonLevel=a}),t.qZA()(),t.TgZ(24,"label"),t._uU(25,"Custom Stocking List?"),t.qZA(),t.TgZ(26,"span")(27,"input",8),t.NdJ("ngModelChange",function(a){return r.stockingListRef=a}),t.qZA()()(),t.TgZ(28,"label"),t._uU(29,"Saved Lists:"),t.qZA(),t.TgZ(30,"div",9),t.YNc(31,qe,2,2,"ng-container",0),t.ALo(32,"async"),t.qZA(),t.TgZ(33,"section",10)(34,"a",2),t.NdJ("click",function(){return r.generateDungeon()}),t._uU(35,"Generate!"),t.qZA()()()(),t.YNc(36,$e,2,0,"ng-template",null,11,t.W1O)),2&e&&(t.xp6(2),t.Q6J("ngIf",t.lcZ(3,7,r.dungeonResult$)),t.xp6(10),t.Q6J("ngModel",r.noRooms),t.xp6(4),t.Q6J("value",r.system),t.xp6(3),t.Q6J("ngForOf",r.supportedSystemKeys),t.xp6(4),t.Q6J("ngModel",r.dungeonLevel),t.xp6(4),t.Q6J("ngModel",r.stockingListRef),t.xp6(4),t.Q6J("ngIf",t.lcZ(32,9,r.monsterEncounterList$)))},dependencies:[m.sg,m.O5,P.A,w.YN,w.Kr,w.Fj,w.wV,w.JJ,w.On,De,m.Ov],styles:["div.encounter-lists[_ngcontent-%COMP%]{display:grid;row-gap:.4em;border:solid 1px #dd7700;grid-template-columns:repeat(3,1fr);margin:.25em 0;max-height:8em;overflow-y:scroll;padding:.25em}div.encounter-lists[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:3em 1fr}section.config-form[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:auto 1fr}section.config-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:0 1em}section.controls[_ngcontent-%COMP%]{margin-top:1em;text-align:center}section.nil[_ngcontent-%COMP%]{text-align:center}.hang-right[_ngcontent-%COMP%]{float:right;margin-right:2em}"]}),n})(),We=(()=>{class n{constructor(e,r){this.specialService=e,this.trapService=r,this.result="~"}clear(){this.result="~"}inspireSpecial(){this.result=this.specialService.generateSpecialEffect()}inspireTrap(){this.result=this.trapService.generateTrickOrTrap()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(H),t.Y36(V))},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-generate-inspiration"]],decls:16,vars:1,consts:[[3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"greg-page-template")(1,"first-content")(2,"p"),t._uU(3),t.qZA()(),t.TgZ(4,"second-content")(5,"label"),t._uU(6,"Inspire From:"),t.qZA(),t.TgZ(7,"ul")(8,"li")(9,"a",0),t.NdJ("click",function(){return r.inspireSpecial()}),t._uU(10,"Special Room"),t.qZA()(),t.TgZ(11,"li")(12,"a",0),t.NdJ("click",function(){return r.inspireTrap()}),t._uU(13,"Trick or Trap"),t.qZA()()(),t.TgZ(14,"a",0),t.NdJ("click",function(){return r.clear()}),t._uU(15,"Clear"),t.qZA()()()),2&e&&(t.xp6(3),t.hij(" ",r.result," "))},dependencies:[P.A],styles:["first-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-style:italic;padding-left:10%;padding-right:10%}second-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:.25em 0}second-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0}"]}),n})();var Be=d(2636);let Ke=(()=>{class n{constructor(){this.pageDisplayMode=Be.L.SINGLE}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-generate-landing"]],decls:4,vars:1,consts:[[3,"pageDisplayMode"]],template:function(e,r){1&e&&(t.TgZ(0,"greg-page-template",0)(1,"first-content")(2,"pre"),t._uU(3,"                                                                                  .(@#.                 .,.                                                                                             \n                                                                                 /@@@@*  .*#@@@@@@@@#. *@@@@(                                                                                           \n                                                                             .///@@@@@@@@@@%(,.   /@@8*8@@@@@*                                                                                          \n                                                                           ./8@@@@@#@@@@,           /@@@@%8@@*     */,                                                                                  \n                                                                      #@@@@@@%*,@@@88@@#            .%@@8@@@@@@@@@@@@#                                                                                  \n                                                                     ,@@%*.    .@@%  (@@/          ,8@@, #@@/,,,. *@@8                                                                                  \n                                                                     %@@/       /@@%  (@%*        .#8#  (@@(      .%@@,                                                                                 \n                                                                    #@@(      .,/#(,              /(.  *@@(        ,@@%.                                                                                \n                                                                  ,@@@(    ,8@@@@@@@@@@%/              .8*          ,@@%.                                                                               \n                                                             ,8@@, .%@@,  %@@(       ./8@@@/      .(8@@@@@@@%/.    .#@@@@/                                                                              \n                                                             #@@@8. /@@%   ..      ./#/, *8@@,  .%@@#,    .*%@@8.,8@@%,                                                                                 \n                                                             *@@@@@*,8@%         .%@@8@@@%  ..  .*/,/@@@@@@* ,(8%(@@*                                                                                   \n                                                              %@@8@@@@@/         /@@8*(@@@@8%/   #@@@@@*(@@8     (@@*                                                                                   \n                                                              ,8@@..,.            .#@@@8/**/8@@* /@@@@@@@@@8#.  *@@#                                                                                    \n                                                               ,8@@,               ,,      .(%/. (@@(... .,#@@88@@#.                                                                                    \n                                                                .8@@(                        .8@@@@8(@@@@@8..#@@(.                                                                                      \n                                                                  *@@@#.         (@@@@%.     .@@@8,(@@% .%@@@@@/                                                                                        \n                                                                    ,%@@@8.     8@@8@@@@@8#,...*%@@@@@   (@@@@8.                                                                                        \n                                                                       .%@@,   /@@/(@@@@@@@@@@@@@8@@@(   #@@@@(                                                                                         \n                                                                        .%@@(  ,@@#     /@@/      %@@/  *@@@@@/                                                                                         \n                                                                        ,8@@@/  /@@8./@@,.      .8#.   *@@8%@@*                                                                                         \n                                                                     *8@@@8(@@%  .%@@@@@@..*(*,/@@@@@@@@@( *@@(                                                                                         \n                                           ,/8@@@@@@@@@@@@@8#/*,(@@@@@@/.   .%@@(   .8@@@@@@@@@@@@@@8*    .8@@@@@(.                                                                                     \n                                      ,%@@@@@8(*,.. ...,,/(8@@@@@#,           ,@@@(           %8/      .#@@@@@@@@@@@@*      ..,,,,..                                                                    \n                                   .#@@@(                                       ,8@@@@@@@%,        .(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/.                                                             \n                                  /@@@.                                            ,/,.,@@@@* (@@@@@@@@@@@@@@@@@@@@@@#.                *8@@@(                                                           \n                                 #@@/                                              .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%.                      *8@@/                                                         \n                                (@@(                                                ,@@@@@@@@@@@@@@@@@8@@@@8/,.,*                           /@@#                                                        \n                               .@@8.                                                  ,%@@@@@@@@@@@@@@8/     .#@@.                           /@@(                                                       \n                               *@@%                                                      *8@@@@@@@@@*                       */.              .#@@.                                                      \n                               (@@%                       #@@,                              *%@@@@@.        #@@*           /@@@               (@@(                        ,,                            \n                               /@@%                     /@@@@.                                  ..           *,            ,8@@               *@@8                     ,%@@@%                           \n                              *8@@(                 ./8@@@@@@*                                          .%%*               ,8@@(              *@@8                  *%@@@%@@@                           \n                            ,@@@/              *##8@@@@@@@@@@@.                                         ./#.               /@@@@/             (@@#              *#@@@8/. #@@*                           \n                           #@@#.               /@@@@@@@@@@@@@@%.                                    ,%#.                  .%@@@@@@            (@@*        ,/#@@@@8(.   ,@@@*                            \n                         .#@@/                  *@@@@@@@@@@@@@@@%(.                       //.       .##.                 .8@@@@@@@@#,*.      *@@@@##%8@@@@@@%/,      ,8@@#.                             \n                         (@@*                    #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@8,   (@(    .*,.            ,#@@@@@@@@@@@@8*      /@@@%#((/,.           /@@@#                                \n                        *@@(                     (@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/     ,%*     (@@@@@@8#,,#%@@@@@@@@@@@@@@@#     ,%@@8/                *%@@@*                                  \n                        @@8.                     (@@8@@@@@@@@@@@@@@@@@@@@@@@@@@@@8/.   ..  /@8*              .,* /8#/*.  ,@@@@@@@@@(   .%@@@(.               *%@@@/                                     \n                       *@@(                     .#@@,.%@@@@@@@8**%@@@@@@@@@@@@@@/           /*                           (@@@@@@@@# *%@@@(.               /8@@@/.                                       \n                       (@@/                     *@@%   ,@@@@@/      ./@@@@@@@@@8      (@@%.    .%@@@8888%#/,.          *%@@@@@@@@%@@@@/               ,#@@@8*                                           \n                       @@@*                    .@@@.     /@@@@*          .*#@@@%  .,   ..         .*,**/#8@@@88@,      /@@@@@@@@@@8*              .#@@@@(.                                              \n                       %@@/                   .@@@,         #@@(                 /@@%.           %@#            .       (@@@@@@#.             .#@@@@#.                                                  \n                       *@@(                  /@@8,           /@@(           .#%.                *@@#                  ,%@@@8*             .#@@@@%%/                                                     \n                       .@@8.               /@@@/              (@@/          .%(     .,*(@@@@@@@@%........         .(@@@@(             ,8@@@@#. (@@%                                                     \n                        *@@#          .*%@@@8,                .#@@*   .@@@*   #@@@@@@@@@8(/*,,.    .(@@@@@@@@@(/@@@@%,            /@@@@@/.     #@@#                               .#@@@/                \n                       %@@@,      .%@@@@@/                     /@@%                                        *@@@@@,           ,%@@@@8,         .8@@/                            *@@@@@@@(                \n                     *8@@,           (@@(                      ,8@8.                                   *8@@@@*          .(@@@@@(..@@@/        (@@8                           *@@@@/(@@@                 \n                    ,8@@.             @@%.                     ,8@8,            ,@@@8,             *8@@@8*          *@@@@@%,     %@@@%.     ,@@@@,                          %@@@@@@@@@#                 \n                    #@@,              @@8.                 .8@@@@@( *@@#          .#@@@@%*.   .(@@@@8*         *%@@@@8*        .#@@%          ,8@@@#.                   .#@@@@@@@@@/                    \n                   .@@%              .@@%.               .%@@%.           (@@%.       ./8@@@@@@@%,        ,%@@@@8/.            *@@@              *@@@@,             .(@@@@@@@@@8,                       \n                   ,@@(              *@@(               .@@@.                   */   .*8@@@@#.       ,#@@@@8(.   (@@(          /@@#                ,8@@8,         /@@@@88@@@@@@@@@@@%,                  \n                   ,@@(              8@@*               @@8,                   ,*@8@@@@8*      .*#@@@@8(.     .      .         /@@%              ,(8@@@@@8.       8@@#*(@@#/(##,.,(8@@@%.    ..         \n                   .@@8             ,@@%.              *@@#                 ,(@@@@8(.     .*#@@@@8(.        .8@@/ *8@@@@@@@@@@@*%@*          ,%@@@@8%/ *@@@#  /8@@@@@#%@@8.    *(*, /@@@/  /@@@@@/      \n                    (@@,            %@@*               8@@*            ,(8@@@8%,     .*#@@@@8(.                  .%@8@@@@@@/,.8@@@@@@@/.  .#@@@%,        8@@@@@/(.#@@88@@@*     (@@@@@@@8@@@@@@@@@/     \n                    ,@@@           *@@@@(.            .8@8,       ,(8@@@@%*     .*#@@@@8(.                .@@#,        .(@@@8,.*(#%#(@@@@@@@%(          #@@#,8@@@#,@@@##@@@#,*,   8@@@@@@8@@@@@%@8*     \n                     /@@%         .%@@@@%.             8@8, ./#@@@@8#,     .*#@@@@8(.  ,@@@/  .((/   (@@,   (,            *@@@%*       *%@@@@%*        (@@@,   /8@@88@@/ #@@@@8, .8@@(  /@@@%.          \n                      *@@@/       /@@@@@#             .8@@@@@@%/.     .*#@@@@%(.              ,##/   */,. //.         ,,,,,.*%@@@@/        *%@@@@8%@@@@@@#      (@@8           ,8@@@%/**%@@%            \n                      (@@#       .@@@@@@%.      ./#@@@@@%(,       *#@@@@%(.           (@8.*#*            ,#@#       /@@@@@@@@@@8%@@@@(/(%88%(*.,(8@@@8#*%@@@%,  #@@#       ,@@%, .8@@@@@@@@(            \n                     *@@8        #@@@@(@@(/#8@@@@@%(,        ,#8@@@8(,                (@@//8/        ,(#.           ,@@@@@@@8@@8,  /8@@@%##%@@@@8@@@%     *%@@@@@@%   /@#(%@@@(   ,@@@ /(/              \n                    .%@@,         ,8@@.%@@@%(*.         ./%@@@@(,                     /@@8    .#@@.  #@8,            .((*#@@@@@@@#           *@@@8(         *8@@@@,  *8@@@@%/ ./##%@@@8/                \n                    *@@#          .%@@.,8@@,        ,#@@@@%*.                         *8@8         .%%,                   *@@@%   (8*       *@@@%#(.  /#/.   .8@@@/ @@@@@@/ /@@@@@@%*#@@@(              \n                    (@@,           /@@% .8@@/   .#@@@@8,                              ,8@8         /@@/                     #@@@/.#@@@%. .#@@@%,@@@@@#@@@@@#(@@@@@@@@@(.#@@@%@@@,8@@8. (@@@.            \n                    8@@             (@@#  #@@%%@@@#@@@(                               /@@8         @@@.                     /@@@@@, *8@@@@@@/   %@@@@@@@@8@@@@@,  #@@8,  ,8@@@/   *@@@%./@@8.           \n                    (@@@8/           /@@%. ,8@@8. /@@#                                (@@(        ,@@(                      .8@@8@@8. .**,.   .*.@8*.#@@@* %@@#.   #@@@@@@@@(     .8@@#*@@@#            \n                  .8@@@@@@@%          .%@@(  /@@@(8@@,                                (@@*        (@@*                      .8@8,*@@@#  .@@@@@@@@(8@@@@@@@@@@@@@@@@@@8(*,.       (@@@8@@@#.             \n                  8@8,  (@@@@%.       ../@@@%, *@@@@8.                                #@@,       .@@%.                       8@8,  /@@@@@@@/.         ....,,,.                 (@@@@@@@#.               \n                  .%@@@@@8*%@@@@@@@@@@@@#. (@@@@8@@@@*                               .8@@        ,@@#                       .8@8.                                            #@@@@@@8,                  \n                              .,,,..           ,*(8@8.                               *@@#        /@@(                       .@@%.                                            ,@@@(@@8                   \n                                                  %@@*                               /@@*        8@@*                       *@@%                                              /@@@@#.                   \n                                                  /@@#                               #@@.       .8@8,                       #@@#                                                                        \n                                                  .@@%.                             .@@#        .8@8.                       #@@*                                                                        \n                                                   /@@/                             /@@/        ,@@%                       .%@@.                                                                        \n                                                    @@8.                            @@8,        /@@%                       /@@%                                                                         \n                                                    *@@#                           *@@#         #@@(                       (@@,                                                                         \n                                                     (@@(                          8@@*         #@@*                      .8@@                                                                          \n                                                      #@@(                        *@@%          #@@,                      /@@*                                                                          \n                                                       /@@@/                      #@@*          %@@,                      @@8.                                                                          \n                                                        .@@%                     *@@8           %@@,                     (@@/                                                                           \n                                                         @@%                    .8@@.           #@@,                   .(@@#                                                                            \n                                                        ,@@(                   #@@%.            /@@#                  #@@8(                                                                             \n                                                        %@@*                   8@@*             #@@(,,               %@@*                                                                               \n                                                       ,@@#.                .%@@@@8.           #@@(#@@,             /@@(                                                                                \n                                                      .8@8,                /@@%.,8@@.        .8@@* /@@*             @@8,                                                                                \n                                                     .%@@*                /@@(   .%@@(     .#@@%.  (@@,            .@@%.                                                                                \n                                                    ,8@@,                .@@8.     (@@8,  (@@@,   .@@%              8@%.                                                                                \n                                                  (8@@#.                  @@@*       #@@@@@8,     @@8,               ..                                                                                 \n                                                .%@@*                     ,@@#         .,.       ./(*                                                                                                   \n                                                *@@(                      *@@(                                                                                                                          \n                                                (@@,                      8@@*                                                                                                                          \n                                                #@@.                     *@@%                                                                                                                           \n                                                #@@.                    .8@@,                                                                                                                           \n                                                (@@,                   .#@@*                                                                                                                            \n                                                /@@*                  .8@@*                                                                                                                             \n                                                 .                   #@@%.                                                                                                                                                                                                                                                                                                                                      \n    "),t.qZA()()()),2&e&&t.Q6J("pageDisplayMode",r.pageDisplayMode)},dependencies:[P.A],styles:["pre[_ngcontent-%COMP%]{font-size:6px}"]}),n})();var Qe=d(5662);function He(n,s){1&n&&(t.TgZ(0,"ng-contanier"),t.Hsn(1),t.qZA())}function Ve(n,s){1&n&&(t.TgZ(0,"p"),t._uU(1,"Click "),t.TgZ(2,"a"),t._uU(3,"Generate!"),t.qZA(),t._uU(4," to generate a result!"),t.qZA())}function je(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"span"),t._uU(2,"\u2022"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA(),t.TgZ(5,"span")(6,"a",6),t.NdJ("click",function(){const a=t.CHM(e).$implicit,o=t.oxw(3);return t.KtG(o.generate(a))}),t._uU(7,"Generate!"),t.qZA()()()}if(2&n){const e=s.$implicit;t.xp6(4),t.AsE("",e.name," ( ",e.system," )")}}function ze(n,s){if(1&n&&(t.ynx(0),t.YNc(1,je,8,2,"div",5),t.BQk()),2&n){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngForOf",e)}}function Xe(n,s){1&n&&(t.TgZ(0,"p"),t._uU(1,"No tables have been configured from which to generate."),t.qZA())}function et(n,s){if(1&n&&(t.TgZ(0,"section",3),t.YNc(1,ze,2,1,"ng-container",0),t.YNc(2,Xe,2,0,"ng-template",null,4,t.W1O),t.qZA()),2&n){const e=s.ngIf,r=t.MAs(3);t.xp6(1),t.Q6J("ngIf",e.length)("ngIfElse",r)}}const tt=[[["result-display"]]],nt=["result-display"];let z=(()=>{class n{set persistenceType(e){this._persistenceType=e,this.derivePersistenceTitle()}get persistenceType(){return this._persistenceType}constructor(e){this.dataService=e,this.generateEvent=new t.vpe,this.PERSISTENCE_TYPES=y.$,this.rollableTableList$=this.dataService.dataState$}ngOnInit(){this.initializeRollableTableListStream(),this.hasGenerated=!1}generate(e){this.hasGenerated=!0,this.generateEvent.emit(e)}derivePersistenceTitle(){for(const e of Object.keys(this.PERSISTENCE_TYPES))if(this.PERSISTENCE_TYPES[e]===this.persistenceType){this.persistenceTitle=e+"s";break}}initializeRollableTableListStream(){const e=Object.keys(this.PERSISTENCE_TYPES).find(r=>this.PERSISTENCE_TYPES[r]===this.persistenceType)+"s";this.rollableTableList$=this.dataService.dataState$.pipe((0,O.U)(r=>r[e]))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(T.L))},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-generator-page-template"]],inputs:{persistenceType:"persistenceType"},outputs:{generateEvent:"generateEvent"},ngContentSelectors:nt,decls:11,vars:8,consts:[[4,"ngIf","ngIfElse"],["notYet",""],["class","rollable-table-list",4,"ngIf"],[1,"rollable-table-list"],["noList",""],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,r){if(1&e&&(t.F$t(tt),t.TgZ(0,"greg-page-template")(1,"first-content"),t.YNc(2,He,2,0,"ng-contanier",0),t.YNc(3,Ve,5,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(5,"second-content")(6,"label"),t._uU(7),t.ALo(8,"fromCamelCase"),t.qZA(),t.YNc(9,et,4,2,"section",2),t.ALo(10,"async"),t.qZA()()),2&e){const i=t.MAs(4);t.xp6(2),t.Q6J("ngIf",r.hasGenerated)("ngIfElse",i),t.xp6(5),t.hij(" ",t.lcZ(8,4,r.persistenceTitle)," "),t.xp6(2),t.Q6J("ngIf",t.lcZ(10,6,r.rollableTableList$))}},dependencies:[m.sg,m.O5,P.A,m.Ov,Qe.O],styles:["first-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;font-style:italic;font-size:smaller}section.rollable-table-list[_ngcontent-%COMP%]{margin:.3em 0}section.rollable-table-list[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:1em 1fr 2fr}"]}),n})();function st(n,s){if(1&n&&(t.ynx(0),t._UZ(1,"greg-display-treasure-results",4),t.BQk()),2&n){const e=s.ngIf;t.xp6(1),t.Q6J("treasureResults",e)}}function it(n,s){1&n&&(t.TgZ(0,"p",5),t._uU(1,"Click "),t.TgZ(2,"a"),t._uU(3,"Generate"),t.qZA(),t._uU(4," to roll a treasure hoard."),t.qZA())}function at(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"article")(1,"span",5),t._uU(2,"\u2022"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA(),t.TgZ(5,"a",7),t.NdJ("click",function(){const a=t.CHM(e).$implicit,o=t.oxw(2);return t.KtG(o.generateTreasure(a))}),t._uU(6,"Generate"),t.qZA()()}if(2&n){const e=s.$implicit;t.xp6(4),t.AsE("",e.system,": ",e.type,"")}}function ot(n,s){if(1&n&&(t.ynx(0),t.YNc(1,at,7,2,"article",6),t.BQk()),2&n){const e=s.ngIf;t.xp6(1),t.Q6J("ngForOf",e)}}function ct(n,s){1&n&&(t.TgZ(0,"p"),t._uU(1,"No treasure types configured."),t.qZA())}function ut(n,s){if(1&n&&(t.TgZ(0,"li"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=s.$implicit,r=t.oxw(2);t.xp6(1),t.AsE(" ",t.xi3(2,2,e.quantity,"1.0")," ",r.prettyName(e.name)," ")}}function pt(n,s){if(1&n&&(t.TgZ(0,"result-display")(1,"label"),t._uU(2),t.qZA(),t.TgZ(3,"ul"),t.YNc(4,ut,3,5,"li",2),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.treasureMapResult.name),t.xp6(2),t.Q6J("ngForOf",e.treasureMapResult.results)}}const gt=[{path:"",component:Ke},{path:"dungeon",component:Je},{path:"inspiration",component:We},{path:"monster-encounter",component:(()=>{class n{constructor(e){this.encounterService=e,this.PERSISTENCE_TYPE=y.$.monsterEncounterList}handleGenerate(e){this.encounterResults=this.encounterService.generateEncounterFromList(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A))},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-generate-monster-encounter"]],decls:3,vars:2,consts:[[3,"persistenceType","generateEvent"],[3,"encounterResults"]],template:function(e,r){1&e&&(t.TgZ(0,"greg-generator-page-template",0),t.NdJ("generateEvent",function(a){return r.handleGenerate(a)}),t.TgZ(1,"result-display"),t._UZ(2,"greg-display-encounter-result",1),t.qZA()()),2&e&&(t.Q6J("persistenceType",r.PERSISTENCE_TYPE),t.xp6(2),t.Q6J("encounterResults",r.encounterResults))},dependencies:[z,j]}),n})()},{path:"treasure-from-type",component:(()=>{class n{constructor(e,r){this.dataService=e,this.treasureGenService=r,this.hoardSource=new J.X([])}ngOnInit(){this.hoard$=this.hoardSource.asObservable(),this.treasureTypeList$=this.dataService.dataState$.pipe((0,O.U)(e=>e.treasureTypes))}generateTreasure(e){this.hoardSource.next(this.treasureGenService.generateTreasure(e))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(T.L),t.Y36(R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-generate-treasure-from-type"]],decls:14,vars:8,consts:[[4,"ngIf","ngIfElse"],["noHoard",""],[1,"treasure-type-list"],["noTypes",""],[3,"treasureResults"],[1,"centered"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,r){if(1&e&&(t.TgZ(0,"greg-page-template")(1,"first-content"),t.YNc(2,st,2,1,"ng-container",0),t.ALo(3,"async"),t.YNc(4,it,5,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(6,"second-content")(7,"section",2)(8,"label"),t._uU(9,"Treasure Types"),t.qZA(),t.YNc(10,ot,2,1,"ng-container",0),t.ALo(11,"async"),t.YNc(12,ct,2,0,"ng-template",null,3,t.W1O),t.qZA()()()),2&e){const i=t.MAs(5),a=t.MAs(13);t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,r.hoard$))("ngIfElse",i),t.xp6(8),t.Q6J("ngIf",t.lcZ(11,6,r.treasureTypeList$))("ngIfElse",a)}},dependencies:[m.sg,m.O5,P.A,Z,m.Ov],styles:["section.treasure-type-list[_ngcontent-%COMP%]   article[_ngcontent-%COMP%]{display:grid;row-gap:.4em;grid-template-columns:2em 1fr 2fr;margin:.2em 0}.centered[_ngcontent-%COMP%]{text-align:center}.right[_ngcontent-%COMP%]{text-align:right}"]}),n})()},{path:"treasure-map",component:(()=>{class n{prettyName(e){const r=e.split("-");return r[r.length-1]}constructor(e){this.treasureService=e,this.PERSISTENCE_TYPE=y.$.treasureMap}handleGenerate(e){this.targetMap=e,this.treasureMapResult=this.treasureService.generateTreasureFromTreasureMap(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["greg-generate-treasure-map"]],decls:2,vars:2,consts:[[3,"persistenceType","generateEvent"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(e,r){1&e&&(t.TgZ(0,"greg-generator-page-template",0),t.NdJ("generateEvent",function(a){return r.handleGenerate(a)}),t.YNc(1,pt,5,2,"result-display",1),t.qZA()),2&e&&(t.Q6J("persistenceType",r.PERSISTENCE_TYPE),t.xp6(1),t.Q6J("ngIf",r.treasureMapResult))},dependencies:[m.sg,m.O5,z,m.JJ]}),n})()}];let ht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,ee.m,$.Bz.forChild(gt),$.Bz]}),n})()}}]);